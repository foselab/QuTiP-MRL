from qutip_mrl.qudit_circuit import QuditCircuit

multiplexer = QuditCircuit(num_qudit=15)

multiplexer.plus1(target=1)
multiplexer.c_feynman_2(A=1, B=3, C=5)
multiplexer.c_feynman_2(A=1, B=7, C=9)
multiplexer.c_feynman_2(A=1, B=11, C=13)
multiplexer.plus1(target=1)
multiplexer.c_feynman_2(A=1, B=2, C=5)
multiplexer.c_feynman_2(A=1, B=6, C=9)
multiplexer.c_feynman_2(A=1, B=10, C=13)
multiplexer.plus1(target=1)
multiplexer.c_feynman_2(A=1, B=4, C=5)
multiplexer.c_feynman_2(A=1, B=8, C=9)
multiplexer.c_feynman_2(A=1, B=12, C=13)
multiplexer.plus1(target=0)
multiplexer.c_feynman_2(A=0, B=9, C=14)
multiplexer.plus1(target=0)
multiplexer.c_feynman_2(A=0, B=5, C=14)
multiplexer.plus1(target=0)
multiplexer.c_feynman_2(A=0, B=13, C=14)

multiplexer.draw()

'''
OUTPUT:
                                                                                                                                                                                                                                                                                                                                                                                                                 +----+                                            +----+                                            +----+                                          
Q0   ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------| +1 |----------------O-------------------O-------| +1 |----------------O-------------------O-------| +1 |----------------O-------------------O-----
                                                                                                                                                                                                                                                                                                                                                                                                                 +----+                |                   |       +----+                |                   |       +----+                |                   |     
           +----+                                                                                                                            +----+                                                                                                                            +----+                                                                                                                                                  |                   |                             |                   |                             |                   |     
Q1   ------| +1 |----------------O-------------------O-------------------O-------------------O-------------------O-------------------O-------| +1 |----------------O-------------------O-------------------O-------------------O-------------------O-------------------O-------| +1 |----------------O-------------------O-------------------O-------------------O-------------------O-------------------O-----------------------------|-------------------|-----------------------------|-------------------|-----------------------------|-------------------|-----
           +----+                |                   |                   |                   |                   |                   |       +----+                |                   |                   |                   |                   |                   |       +----+                |                   |                   |                   |                   |                   |                             |                   |                             |                   |                             |                   |     
                                 |                   |                   |                   |                   |                   |                           +----+              +----+                |                   |                   |                   |                             |                   |                   |                   |                   |                   |                             |                   |                             |                   |                             |                   |     
Q2   ----------------------------|-------------------|-------------------|-------------------|-------------------|-------------------|-------------------O-------| 12 |------O-------| 12 |----------------|-------------------|-------------------|-------------------|-----------------------------|-------------------|-------------------|-------------------|-------------------|-------------------|-----------------------------|-------------------|-----------------------------|-------------------|-----------------------------|-------------------|-----
                                 |                   |                   |                   |                   |                   |                   |       +----+      |       +----+                |                   |                   |                   |                             |                   |                   |                   |                   |                   |                             |                   |                             |                   |                             |                   |     
                               +----+              +----+                |                   |                   |                   |                   |                   |                             |                   |                   |                   |                             |                   |                   |                   |                   |                   |                             |                   |                             |                   |                             |                   |     
Q3   ------------------O-------| 12 |------O-------| 12 |----------------|-------------------|-------------------|-------------------|-------------------|-------------------|-----------------------------|-------------------|-------------------|-------------------|-----------------------------|-------------------|-------------------|-------------------|-------------------|-------------------|-----------------------------|-------------------|-----------------------------|-------------------|-----------------------------|-------------------|-----
                       |       +----+      |       +----+                |                   |                   |                   |                   |                   |                             |                   |                   |                   |                             |                   |                   |                   |                   |                   |                             |                   |                             |                   |                             |                   |     
                       |                   |                             |                   |                   |                   |                   |                   |                             |                   |                   |                   |                           +----+              +----+                |                   |                   |                   |                             |                   |                             |                   |                             |                   |     
Q4   ------------------|-------------------|-----------------------------|-------------------|-------------------|-------------------|-------------------|-------------------|-----------------------------|-------------------|-------------------|-------------------|-------------------O-------| 12 |------O-------| 12 |----------------|-------------------|-------------------|-------------------|-----------------------------|-------------------|-----------------------------|-------------------|-----------------------------|-------------------|-----
                       |                   |                             |                   |                   |                   |                   |                   |                             |                   |                   |                   |                   |       +----+      |       +----+                |                   |                   |                   |                             |                   |                             |                   |                             |                   |     
                     +----+              +----+                          |                   |                   |                   |                 +----+              +----+                          |                   |                   |                   |                 +----+              +----+                          |                   |                   |                   |                             |                   |                           +----+              +----+                          |                   |     
Q5   ----------------| +2 |--------------| +1 |--------------------------|-------------------|-------------------|-------------------|-----------------| +2 |--------------| +1 |--------------------------|-------------------|-------------------|-------------------|-----------------| +2 |--------------| +1 |--------------------------|-------------------|-------------------|-------------------|-----------------------------|-------------------|-------------------O-------| 12 |------O-------| 12 |--------------------------|-------------------|-----
                     +----+              +----+                          |                   |                   |                   |                 +----+              +----+                          |                   |                   |                   |                 +----+              +----+                          |                   |                   |                   |                             |                   |                   |       +----+      |       +----+                          |                   |     
                                                                         |                   |                   |                   |                                                                   +----+              +----+                |                   |                                                                     |                   |                   |                   |                             |                   |                   |                   |                                       |                   |     
Q6   --------------------------------------------------------------------|-------------------|-------------------|-------------------|-----------------------------------------------------------O-------| 12 |------O-------| 12 |----------------|-------------------|---------------------------------------------------------------------|-------------------|-------------------|-------------------|-----------------------------|-------------------|-------------------|-------------------|---------------------------------------|-------------------|-----
                                                                         |                   |                   |                   |                                                           |       +----+      |       +----+                |                   |                                                                     |                   |                   |                   |                             |                   |                   |                   |                                       |                   |     
                                                                       +----+              +----+                |                   |                                                           |                   |                             |                   |                                                                     |                   |                   |                   |                             |                   |                   |                   |                                       |                   |     
Q7   ----------------------------------------------------------O-------| 12 |------O-------| 12 |----------------|-------------------|-----------------------------------------------------------|-------------------|-----------------------------|-------------------|---------------------------------------------------------------------|-------------------|-------------------|-------------------|-----------------------------|-------------------|-------------------|-------------------|---------------------------------------|-------------------|-----
                                                               |       +----+      |       +----+                |                   |                                                           |                   |                             |                   |                                                                     |                   |                   |                   |                             |                   |                   |                   |                                       |                   |     
                                                               |                   |                             |                   |                                                           |                   |                             |                   |                                                                   +----+              +----+                |                   |                             |                   |                   |                   |                                       |                   |     
Q8   ----------------------------------------------------------|-------------------|-----------------------------|-------------------|-----------------------------------------------------------|-------------------|-----------------------------|-------------------|-----------------------------------------------------------O-------| 12 |------O-------| 12 |----------------|-------------------|-----------------------------|-------------------|-------------------|-------------------|---------------------------------------|-------------------|-----
                                                               |                   |                             |                   |                                                           |                   |                             |                   |                                                           |       +----+      |       +----+                |                   |                             |                   |                   |                   |                                       |                   |     
                                                             +----+              +----+                          |                   |                                                         +----+              +----+                          |                   |                                                         +----+              +----+                          |                   |                           +----+              +----+                |                   |                                       |                   |     
Q9   --------------------------------------------------------| +2 |--------------| +1 |--------------------------|-------------------|---------------------------------------------------------| +2 |--------------| +1 |--------------------------|-------------------|---------------------------------------------------------| +2 |--------------| +1 |--------------------------|-------------------|-------------------O-------| 12 |------O-------| 12 |----------------|-------------------|---------------------------------------|-------------------|-----
                                                             +----+              +----+                          |                   |                                                         +----+              +----+                          |                   |                                                         +----+              +----+                          |                   |                   |       +----+      |       +----+                |                   |                                       |                   |     
                                                                                                                 |                   |                                                                                                           +----+              +----+                                                                                                          |                   |                   |                   |                             |                   |                                       |                   |     
Q10  ------------------------------------------------------------------------------------------------------------|-------------------|---------------------------------------------------------------------------------------------------O-------| 12 |------O-------| 12 |----------------------------------------------------------------------------------------------------------|-------------------|-------------------|-------------------|-----------------------------|-------------------|---------------------------------------|-------------------|-----
                                                                                                                 |                   |                                                                                                   |       +----+      |       +----+                                                                                                          |                   |                   |                   |                             |                   |                                       |                   |     
                                                                                                               +----+              +----+                                                                                                |                   |                                                                                                                       |                   |                   |                   |                             |                   |                                       |                   |     
Q11  --------------------------------------------------------------------------------------------------O-------| 12 |------O-------| 12 |------------------------------------------------------------------------------------------------|-------------------|-----------------------------------------------------------------------------------------------------------------------|-------------------|-------------------|-------------------|-----------------------------|-------------------|---------------------------------------|-------------------|-----
                                                                                                       |       +----+      |       +----+                                                                                                |                   |                                                                                                                       |                   |                   |                   |                             |                   |                                       |                   |     
                                                                                                       |                   |                                                                                                             |                   |                                                                                                                     +----+              +----+                |                   |                             |                   |                                       |                   |     
Q12  --------------------------------------------------------------------------------------------------|-------------------|-------------------------------------------------------------------------------------------------------------|-------------------|-------------------------------------------------------------------------------------------------------------O-------| 12 |------O-------| 12 |----------------|-------------------|-----------------------------|-------------------|---------------------------------------|-------------------|-----
                                                                                                       |                   |                                                                                                             |                   |                                                                                                             |       +----+      |       +----+                |                   |                             |                   |                                       |                   |     
                                                                                                     +----+              +----+                                                                                                        +----+              +----+                                                                                                        +----+              +----+                          |                   |                             |                   |                                     +----+              +----+  
Q13  ------------------------------------------------------------------------------------------------| +2 |--------------| +1 |--------------------------------------------------------------------------------------------------------| +2 |--------------| +1 |--------------------------------------------------------------------------------------------------------| +2 |--------------| +1 |--------------------------|-------------------|-----------------------------|-------------------|-----------------------------O-------| 12 |------O-------| 12 |--
                                                                                                     +----+              +----+                                                                                                        +----+              +----+                                                                                                        +----+              +----+                          |                   |                             |                   |                             |       +----+      |       +----+  
                                                                                                                                                                                                                                                                                                                                                                                                                           +----+              +----+                        +----+              +----+                        +----+              +----+            
Q14  ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------| +2 |--------------| +1 |------------------------| +2 |--------------| +1 |------------------------| +2 |--------------| +1 |------------
                                                                                                                                                                                                                                                                                                                                                                                                                           +----+              +----+                        +----+              +----+                        +----+              +----+            
'''

multiplexer.simulate_einsum()

'''
OUTPUT:

QUDIT 0 state probabilities:
  1
  0
  0
QUDIT 1 state probabilities:
  1
  0
  0
QUDIT 2 state probabilities:
  1
  0
  0
QUDIT 3 state probabilities:
  1
  0
  0
QUDIT 4 state probabilities:
  1
  0
  0
QUDIT 5 state probabilities:
  1
  0
  0
QUDIT 6 state probabilities:
  1
  0
  0
QUDIT 7 state probabilities:
  1
  0
  0
QUDIT 8 state probabilities:
  1
  0
  0
QUDIT 9 state probabilities:
  1
  0
  0
QUDIT 10 state probabilities:
  1
  0
  0
QUDIT 11 state probabilities:
  1
  0
  0
QUDIT 12 state probabilities:
  1
  0
  0
QUDIT 13 state probabilities:
  1
  0
  0
QUDIT 14 state probabilities:
  1
  0
  0
'''

multiplexer.simulate_fullmatrix()

'''
OUTPUT:

Not working for large circuits
'''

